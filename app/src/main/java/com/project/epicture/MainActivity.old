package com.project.epicture

import android.app.Activity
import android.content.Intent
import android.net.Uri
import android.os.Bundle
import android.widget.Button
import android.widget.ImageView
import androidx.appcompat.app.AppCompatActivity
import androidx.core.content.ContextCompat
import com.project.epicture.api.*
import retrofit2.Call
import retrofit2.Retrofit
import retrofit2.converter.gson.GsonConverterFactory
import retrofit2.Callback
import retrofit2.Response
import com.project.epicture.utils.SharedPreference
import com.project.epicture.api.uploadActivity
import android.content.pm.PackageManager
import java.util.jar.Manifest

class MainActivity : AppCompatActivity(), ImgurCalls.ResponseAccountSettingsCallbacks, ImgurCalls.ResponseAccountImagesCallbacks {
    private var access_token = null
    private val tanUrl = "https://api.imgur.com"
    val retrofit = Retrofit.Builder()
            .baseUrl(tanUrl)
            .addConverterFactory(GsonConverterFactory.create())
            .build()

    override fun onCreate(savedInstanceState: Bundle?) {
        val shared:SharedPreference = SharedPreference(this)
        shared.clearSharedPreference()
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        val intent = Intent(this, LoginActivity::class.java)
        startActivity(intent)
    }
    override fun onResume() {
        super.onResume()
        val shared:SharedPreference = SharedPreference(this)
        val tok = shared.getValueString("access_token")
        if (tok == null)
            return
  /*      findViewById<Button>(R.id.upload_button).setOnClickListener {
            val intent = Intent(this, uploadActivity::class.java)
            startActivity(intent)
        }*/
        //ImgurCalls().getAccountImage(this, tok)
        //ImgurCalls().getAccountSettings(this, tok)
    }


    override fun onResponse(response: ImgurModels.ResponseAccountImages?) {
        if (response != null)
            println(response)
    }

    override fun onResponse(response: ImgurModels.ResponseAccountSettings?) {
        if (response != null)
            println(response)
    }
    override fun onFailure() {
        println("----->" + intent.data)
    }
}